{% extends 'base.html' %}
{% load static %}

{% block title %}{{ article.title }} - Axflo Oil & Gas{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'axflo_app/css/media.css' %}">
{% endblock %}

{% block content %}

{% include 'axflo_app/includes/navbar.html' %}

<!-- Ultra-Modern Blog Detail Hero -->
<section class="blog-detail-hero">
    <!-- Dynamic Background -->
    <div class="hero-background"></div>
    
    <!-- Animated Grid -->
    <div class="grid-overlay"></div>
    
    <!-- Floating Geometric Elements -->
    <div class="geometric-elements">
        <div class="geometric-shape shape-1"></div>
        <div class="geometric-shape shape-2"></div>
        <div class="geometric-shape shape-3"></div>
    </div>
    
    <!-- Glass Accent -->
    <div class="glass-accent"></div>
    
    <!-- Featured Image -->
    {% if article.get_image_url %}
    <div class="blog-hero-image">
        <img src="{{ article.get_image_url }}" alt="{{ article.image_alt|default:article.title }}" class="hero-bg-image">
        <div class="hero-image-overlay"></div>
    </div>
    {% endif %}
    
    <!-- Hero Content -->
    <div class="blog-hero-content">
        <!-- Breadcrumb -->
        <nav class="blog-breadcrumb" data-aos="fade-up">
            <a href="{% url 'axflo_app:index' %}">Home</a>
            <span class="breadcrumb-separator">→</span>
            <a href="{% url 'axflo_app:media' %}">Media</a>
            <span class="breadcrumb-separator">→</span>
            <span class="breadcrumb-current">{{ article.title|truncatechars:40 }}</span>
        </nav>
        
        <!-- Category Badge -->
        {% if article.category %}
        <div class="blog-hero-category" data-aos="fade-up" data-aos-delay="100">
            <div class="category-dot"></div>
            {{ article.category.name }}
        </div>
        {% endif %}
        
        <!-- Title -->
        <h1 class="blog-hero-title" data-aos="fade-up" data-aos-delay="200">
            {{ article.title }}
        </h1>
        
        <!-- Excerpt -->
        {% if article.excerpt %}
        <p class="blog-hero-excerpt" data-aos="fade-up" data-aos-delay="300">
            {{ article.excerpt }}
        </p>
        {% endif %}
        
        <!-- Meta Information -->
        <div class="blog-hero-meta" data-aos="fade-up" data-aos-delay="400">
            <div class="meta-item">
                <i class="fas fa-calendar-alt"></i>
                <span>{{ article.published_at|date:"M d, Y" }}</span>
            </div>
            <div class="meta-item">
                <i class="fas fa-clock"></i>
                <span>{{ article.content|wordcount|floatformat:0 }} min read</span>
            </div>
            <div class="meta-item">
                <i class="fas fa-eye"></i>
                <span>{{ article.view_count }} views</span>
            </div>
            {% if article.author %}
            <div class="meta-item">
                <i class="fas fa-user"></i>
                <span>{{ article.author }}</span>
            </div>
            {% endif %}
        </div>
        
        <!-- Tags -->
        {% if article.tags %}
        <div class="blog-hero-tags" data-aos="fade-up" data-aos-delay="500">
            {% for tag in article.get_tag_list %}
            <span class="hero-tag">{{ tag }}</span>
            {% endfor %}
        </div>
        {% endif %}
        
        <!-- Scroll Indicator -->
        <div class="scroll-indicator" data-aos="fade-up" data-aos-delay="600">
            <div class="scroll-mouse">
                <div class="scroll-wheel"></div>
            </div>
            <span>Scroll to read</span>
        </div>
    </div>
</section>

<!-- Blog Content Section -->
<section class="blog-content-section">
    <div class="blog-detail-container">
        <!-- Main Content -->
        <article class="blog-detail-main">
            <!-- Reading Progress Bar -->
            <div class="reading-progress">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            
            <!-- Content Body -->
            <div class="blog-content-body" data-aos="fade-up">
                <!-- Social Share Floating -->
                <!-- <div class="social-share-floating">
                    <div class="share-title">Share</div>
                    <a href="#" onclick="shareOnFacebook()" class="share-btn facebook" title="Share on Facebook">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="#" onclick="shareOnTwitter()" class="share-btn twitter" title="Share on Twitter">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="#" onclick="shareOnLinkedIn()" class="share-btn linkedin" title="Share on LinkedIn">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                    <a href="#" onclick="copyToClipboard()" class="share-btn copy" title="Copy Link">
                        <i class="fas fa-link"></i>
                    </a>
                </div> -->
                
                <!-- Article Content -->
                <div class="article-text">
                    {{ article.content|linebreaks }}
                </div>
                
                <!-- Article Footer -->
                <div class="article-footer">
                    <!-- Tags -->
                    {% if article.tags %}
                    <div class="article-tags-section">
                        <h4>Tags</h4>
                        <div class="article-tags">
                            {% for tag in article.get_tag_list %}
                            <span class="article-tag">{{ tag }}</span>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                    
                    <!-- Share Section -->
                    <div class="article-share-section">
                        <h4>Share this article</h4>
                        <div class="share-buttons">
                            <button onclick="shareOnFacebook()" class="share-button facebook">
                                <i class="fab fa-facebook-f"></i>
                                <span>Facebook</span>
                            </button>
                            <button onclick="shareOnTwitter()" class="share-button twitter">
                                <i class="fab fa-twitter"></i>
                                <span>Twitter</span>
                            </button>
                            <button onclick="shareOnLinkedIn()" class="share-button linkedin">
                                <i class="fab fa-linkedin-in"></i>
                                <span>LinkedIn</span>
                            </button>
                            <button onclick="copyToClipboard()" class="share-button copy">
                                <i class="fas fa-link"></i>
                                <span>Copy Link</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Navigation -->
            <div class="blog-navigation" data-aos="fade-up">
                <a href="{% url 'axflo_app:media' %}" class="nav-btn back-to-blog">
                    <i class="fas fa-arrow-left"></i>
                    <span>Back to Blog</span>
                </a>
                
                <!-- Previous/Next Articles would go here if implemented -->
            </div>
        </article>
        
        <!-- Sidebar -->
        <aside class="blog-detail-sidebar">
            <!-- Table of Contents (if content has headings) -->
            <div class="sidebar-section toc-section" data-aos="fade-up">
                <h3 class="sidebar-title">
                    <i class="fas fa-list"></i>
                    Quick Navigation
                </h3>
                <div class="table-of-contents">
                    <a href="#" class="toc-item active">Introduction</a>
                    <a href="#" class="toc-item">Key Features</a>
                    <a href="#" class="toc-item">Implementation</a>
                    <a href="#" class="toc-item">Conclusion</a>
                </div>
            </div>
            
            <!-- Related Articles -->
            {% if related_articles %}
            <div class="sidebar-section" data-aos="fade-up" data-aos-delay="100">
                <h3 class="sidebar-title">
                    <i class="fas fa-newspaper"></i>
                    Related Articles
                </h3>
                {% for related in related_articles %}
                <article class="related-article">
                    {% if related.get_image_url %}
                    <div class="related-image">
                        <img src="{{ related.get_image_url }}" alt="{{ related.title }}">
                    </div>
                    {% endif %}
                    <div class="related-content">
                        <h4 class="related-title">
                            <a href="{% url 'axflo_app:blog_detail' slug=related.slug %}">{{ related.title|truncatechars:60 }}</a>
                        </h4>
                        <div class="related-meta">
                            <span><i class="fas fa-calendar-alt"></i> {{ related.published_at|date:"M d" }}</span>
                            <span><i class="fas fa-eye"></i> {{ related.view_count }}</span>
                        </div>
                    </div>
                </article>
                {% endfor %}
            </div>
            {% endif %}
            
            <!-- Recent Articles -->
            {% if recent_articles %}
            <div class="sidebar-section" data-aos="fade-up" data-aos-delay="200">
                <h3 class="sidebar-title">
                    <i class="fas fa-clock"></i>
                    Recent Posts
                </h3>
                {% for recent in recent_articles %}
                <div class="recent-post">
                    <h5 class="recent-title">
                        <a href="{% url 'axflo_app:blog_detail' slug=recent.slug %}">{{ recent.title|truncatechars:50 }}</a>
                    </h5>
                    <div class="recent-meta">
                        {{ recent.published_at|date:"M d, Y" }}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            
            <!-- Categories -->
            {% if categories %}
            <div class="sidebar-section" data-aos="fade-up" data-aos-delay="300">
                <h3 class="sidebar-title">
                    <i class="fas fa-tags"></i>
                    Categories
                </h3>
                {% for category in categories %}
                <a href="{% url 'axflo_app:media' %}?category={{ category.slug }}" class="category-link">
                    {{ category.name }}
                    <span class="category-count">{{ category.newsarticle_set.count }}</span>
                </a>
                {% endfor %}
            </div>
            {% endif %}
        </aside>
    </div>
</section>

{% include 'axflo_app/includes/footer.html' %}

<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

{% endblock %}

{% block extra_js %}
<script src="{% static 'axflo_app/js/media.js' %}"></script>
<script src="{% static 'axflo_app/js/main.js' %}"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize AOS
    AOS.init({
        duration: 1000,
        easing: 'ease-out-cubic',
        once: true
    });
    
    // Reading Progress Bar
    function updateProgressBar() {
        const article = document.querySelector('.blog-content-body');
        const progressBar = document.getElementById('progressBar');
        
        if (article && progressBar) {
            const articleTop = article.offsetTop;
            const articleHeight = article.offsetHeight;
            const windowHeight = window.innerHeight;
            const scrollTop = window.pageYOffset;
            
            const progress = Math.min(
                Math.max((scrollTop - articleTop + windowHeight / 2) / articleHeight, 0),
                1
            );
            
            progressBar.style.width = (progress * 100) + '%';
        }
    }
    
    window.addEventListener('scroll', updateProgressBar);
    updateProgressBar();
    
    // Smooth scroll for TOC
    document.querySelectorAll('.toc-item').forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            // TOC functionality would be implemented here
        });
    });
});

// Social Share Functions
function shareOnFacebook() {
    const url = encodeURIComponent(window.location.href);
    const title = encodeURIComponent(document.title);
    window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank', 'width=600,height=400');
}

function shareOnTwitter() {
    const url = encodeURIComponent(window.location.href);
    const title = encodeURIComponent(document.title);
    window.open(`https://twitter.com/intent/tweet?url=${url}&text=${title}`, '_blank', 'width=600,height=400');
}

function shareOnLinkedIn() {
    const url = encodeURIComponent(window.location.href);
    window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${url}`, '_blank', 'width=600,height=400');
}

function copyToClipboard() {
    navigator.clipboard.writeText(window.location.href).then(function() {
        // Show a temporary notification
        const copyBtn = document.querySelector('.share-btn.copy');
        const originalIcon = copyBtn.innerHTML;
        copyBtn.innerHTML = '<i class="fas fa-check"></i>';
        copyBtn.style.background = '#10b981';
        
        setTimeout(() => {
            copyBtn.innerHTML = originalIcon;
            copyBtn.style.background = '';
        }, 2000);
    });
}
</script>
{% endblock %}