{% extends "admin/auth/user/base.html" %}
{% load i18n admin_urls static admin_modify %}

{% block extrahead %}
    {{ block.super }}
    <style>
        .profile-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #007cba;
        }
        .profile-section h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 16px;
            font-weight: 600;
        }
        .profile-actions {
            margin-top: 20px;
            padding: 15px;
            background: #fff;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        .profile-actions .button {
            margin-right: 10px;
            margin-bottom: 10px;
        }
        .danger-zone {
            background: #fff5f5;
            border-left-color: #dc3545;
            border: 1px solid #f5c6cb;
        }
        .danger-zone h3 {
            color: #721c24;
        }
        .btn-danger {
            background-color: #dc3545;
            border-color: #dc3545;
            color: white;
            padding: 8px 16px;
            text-decoration: none;
            border-radius: 4px;
            display: inline-block;
            margin-top: 10px;
        }
        .btn-danger:hover {
            background-color: #c82333;
            border-color: #bd2130;
            color: white;
            text-decoration: none;
        }
        .help-text {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
    </style>
{% endblock %}

{% block content %}
    <div class="profile-section">
        <h3>{% trans 'Profile Management' %}</h3>
        <p>{% trans 'Manage your user account settings and profile information.' %}</p>
        
        {% if user.is_superuser %}
            <p><strong>{% trans 'Administrator Access' %}</strong> - You have full administrative privileges.</p>
        {% else %}
            <p><strong>{% trans 'User Profile' %}</strong> - You can update your own profile information.</p>
        {% endif %}
    </div>

    {{ block.super }}

    {% if original %}
        <div class="profile-actions">
            <h3>{% trans 'Quick Actions' %}</h3>
            
            <!-- Change Password -->
            <a href="{% url 'admin:auth_user_password_change' original.pk %}" class="button">
                {% trans 'Change Password' %}
            </a>
            <div class="help-text">{% trans 'Update your account password for security.' %}</div>
            
            <!-- View Profile -->
            {% if not user.is_superuser and original == user %}
                <a href="{% url 'admin:auth_user_change' original.pk %}" class="button">
                    {% trans 'Edit My Profile' %}
                </a>
                <div class="help-text">{% trans 'Update your personal information and settings.' %}</div>
            {% endif %}
        </div>

        <!-- Danger Zone - Only for self-deletion or superuser -->
        {% if user.is_superuser or original == user %}
            <div class="profile-section danger-zone">
                <h3>{% trans 'Danger Zone' %}</h3>
                <p>{% trans 'Irreversible and destructive actions.' %}</p>
                
                {% if original == user %}
                    <p><strong>{% trans 'Delete My Account' %}</strong></p>
                    <p>{% trans 'Permanently delete your user account. This action cannot be undone.' %}</p>
                    <a href="{% url 'admin:auth_user_delete' original.pk %}" class="btn-danger" 
                       onclick="return confirm('{% trans "Are you sure you want to delete your account? This action cannot be undone." %}')">
                        {% trans 'Delete My Account' %}
                    </a>
                {% elif user.is_superuser %}
                    <p><strong>{% trans 'Delete User Account' %}</strong></p>
                    <p>{% trans 'Permanently delete this user account. This action cannot be undone.' %}</p>
                    <a href="{% url 'admin:auth_user_delete' original.pk %}" class="btn-danger"
                       onclick="return confirm('{% trans "Are you sure you want to delete this user account? This action cannot be undone." %}')">
                        {% trans 'Delete User Account' %}
                    </a>
                {% endif %}
            </div>
        {% endif %}
    {% endif %}
{% endblock %}

{% block submit_buttons_bottom %}
    {{ block.super }}
    
    {% if original and original == user %}
        <div style="margin-top: 15px; padding: 10px; background: #e8f4fd; border-radius: 4px;">
            <p style="margin: 0; color: #0c5460;">
                <strong>{% trans 'Note:' %}</strong> 
                {% trans 'You are editing your own profile. Changes will affect your login and access.' %}
            </p>
        </div>
    {% endif %}
{% endblock %}